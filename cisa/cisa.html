<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Recent CISA Vulnerabilities</title>

    <link rel="stylesheet" href="cisa.css">
    <link rel="stylesheet" href="../style.css" />
    <script src="../theme.js"></script>

    <link rel="icon" href="data:image/svg+xml;utf8,
<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'>
  <circle cx='50' cy='50' r='50' fill='%23800000'/>
  <path d='M50 15 L75 30 L75 60 C75 70 65 80 50 85 C35 80 25 70 25 60 L25 30 Z' fill='%23ffffff'/>
  <circle cx='50' cy='45' r='10' fill='%23800000'/>
  <rect x='45' y='45' width='10' height='20' fill='%23800000'/>
  <path d='M40 45 L60 45' stroke='%23800000' stroke-width='3'/>
</svg>" type="image/svg+xml" />
</head>

<body>
    <header class="header">
        <div class="back-button-container">
            <a href="../index.html" class="back-button">Back to Main Page</a>
        </div>
        <h1>Recent Exploited Vulnerabilities</h1>
    </header>

    <main class="main-container">
        <!-- Header section with title and fetch info -->
        <div class="control-panel">
            <div class="left-controls">
                <div id="header-information" class="header-information">
                    <h3 id="dynamic-title">CISA Known Exploited Vulnerabilities</h3>
                    <p><strong>Last Updated:</strong> <span id="last-fetch-date">Loading...</span></p>
                </div>
            </div>

            <!-- Updated Controls with Ransomware Filter and Export -->
            <div class="right-controls">
                <div class="filter-group">
                    <label for="ransomware-filter" class="control-label">Ransomware:</label>
                    <select id="ransomware-filter" class="control-dropdown">
                        <option value="all">All Types</option>
                        <option value="yes">Known Ransomware</option>
                        <option value="no">No Ransomware</option>
                        <option value="unknown">Unknown</option>
                    </select>
                </div>

                <div class="filter-group">
                    <label for="search-input" class="control-label">Search:</label>
                    <input type="text" id="search-input" class="control-dropdown"
                        placeholder="Search vulnerabilities..." />
                </div>

                <button id="cisa-export-btn" class="export-button">Export CSV</button>
            </div>
        </div>

        <!-- New Time Filter Section -->
        <div class="filter-section">
            <div class="time-filter-group">
                <label class="control-label">Time Range:</label>
                <div class="time-buttons">
                    <button class="time-filter-btn active" data-time="all">All Time</button>
                    <button class="time-filter-btn" data-time="today">Today</button>
                    <button class="time-filter-btn" data-time="3days">Last 3 Days</button>
                    <button class="time-filter-btn" data-time="week">Last Week</button>
                    <button class="time-filter-btn" data-time="month">Last Month</button>
                    <button class="time-filter-btn" data-time="3months">Last 3 Months</button>
                    <button class="time-filter-btn" data-time="6months">Last 6 Months</button>
                </div>
            </div>
        </div>

        <!-- Stats Summary -->
        <div class="stats-summary">
            <div class="stat-card total">
                <div class="stat-number" id="total-vulns">0</div>
                <div class="stat-label">Total Vulnerabilities</div>
            </div>
            <div class="stat-card ransomware">
                <div class="stat-number" id="ransomware-count">0</div>
                <div class="stat-label">Known Ransomware</div>
            </div>
            <div class="stat-card safe">
                <div class="stat-number" id="safe-count">0</div>
                <div class="stat-label">No Ransomware</div>
            </div>
            <div class="stat-card unknown">
                <div class="stat-number" id="unknown-count">0</div>
                <div class="stat-label">Unknown Status</div>
            </div>
            <div class="stat-card recent">
                <div class="stat-number" id="recent-count">0</div>
                <div class="stat-label">Added This Month</div>
            </div>
        </div>

        <!-- View Toggle Buttons -->
        <div class="view-switcher">
            <div class="view-toggle-label">View:</div>
            <div class="view-toggle-buttons">
                <button id="grid-view-btn" class="view-btn active" aria-label="Grid view">
                    <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" fill="none">
                        <rect x="3" y="3" width="7" height="7" rx="1"></rect>
                        <rect x="14" y="3" width="7" height="7" rx="1"></rect>
                        <rect x="3" y="14" width="7" height="7" rx="1"></rect>
                        <rect x="14" y="14" width="7" height="7" rx="1"></rect>
                    </svg>
                    <span>Grid</span>
                </button>
                <button id="list-view-btn" class="view-btn" aria-label="List view">
                    <svg viewBox="0 0 24 24" width="18" height="18" stroke="currentColor" fill="none">
                        <line x1="3" y1="6" x2="21" y2="6"></line>
                        <line x1="3" y1="12" x2="21" y2="12"></line>
                        <line x1="3" y1="18" x2="21" y2="18"></line>
                    </svg>
                    <span>List</span>
                </button>
            </div>
        </div>

        <!-- Vulnerability container -->
        <div id="vulnerability-container" class="vulnerability-grid">
            <div class="loading-animation"></div>
        </div>
    </main>
    <script src="cisa.js"></script>
</body>

</html>